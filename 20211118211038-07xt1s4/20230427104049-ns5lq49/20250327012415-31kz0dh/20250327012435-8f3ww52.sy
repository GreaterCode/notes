{
	"ID": "20250327012435-8f3ww52",
	"Spec": "1",
	"Type": "NodeDocument",
	"Properties": {
		"id": "20250327012435-8f3ww52",
		"title": "计算虚拟化3——IO设备虚拟化",
		"type": "doc",
		"updated": "20250408165016"
	},
	"Children": [
		{
			"ID": "20250327012435-810lwve",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20250327012435-810lwve",
				"updated": "20250327012435"
			}
		},
		{
			"ID": "20250327012435-6ds5bpa",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-6ds5bpa",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"ID": "20250327012435-zyu1mvl",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250327012435-zyu1mvl",
						"updated": "20250327012435"
					},
					"Children": [
						{
							"ID": "20250327012435-knptl2e",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250327012435-knptl2e",
								"updated": "20250327012435"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "a",
									"TextMarkAHref": "https://blog.csdn.net/m0_49864110/article/details/134223939?spm=1001.2014.3001.5501",
									"TextMarkTextContent": "https://blog.csdn.net/m0_49864110/article/details/134223939?spm=1001.2014.3001.5501"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-728jvxb",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20250327012435-728jvxb",
				"updated": "20250327012435"
			}
		},
		{
			"ID": "20250327012435-01waejq",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20250327012435-01waejq",
				"updated": "20250328014541"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1. I/O基本概念"
				}
			]
		},
		{
			"ID": "20250327012435-ill35k6",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20250327012435-ill35k6",
				"updated": "20250328014541"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.1 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "什么是I/O设备"
				}
			]
		},
		{
			"ID": "20250327012435-qynpmpo",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-qynpmpo",
				"updated": "20250327171919"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\tI/O就是输入输出，而I/O设备就是可以将数据输入到计算机，或者将计算机的数据输出到其他设备，属于计算机的硬件设备"
				}
			]
		},
		{
			"ID": "20250327012435-be8544x",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-be8544x",
				"updated": "20250328014541"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\tI/O设备具体使用什么类型的数据、做什么事情取决于I/O设备本身的功能，不同功能的I/O设备传输数据可能不同（例如：磁盘会将数据持久化、网卡会将数据转发到其它主机）"
				}
			]
		},
		{
			"ID": "20250327012435-owytrd8",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20250327012435-owytrd8",
				"updated": "20250327173019"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "1.2 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "I/O设备的分类"
				}
			]
		},
		{
			"ID": "20250327012435-styydc4",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-styydc4",
				"updated": "20250327172847"
			},
			"Children": [
				{
					"ID": "20250327171936-0qbn51p",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250327171936-0qbn51p",
						"updated": "20250327172847"
					},
					"Children": [
						{
							"ID": "20250327171936-7nsm5ft",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250327171936-7nsm5ft",
								"updated": "20250327172847"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "存储I/O设备（块设备-可以寻址），也称外存，用来存储设信息。例如：硬盘、光盘、U盘等"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-xivhyaq",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-xivhyaq",
				"updated": "20250327172928"
			},
			"Children": [
				{
					"ID": "20250327172854-2xkuk60",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250327172854-2xkuk60",
						"updated": "20250327172928"
					},
					"Children": [
						{
							"ID": "20250327172854-wig23j9",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250327172854-wig23j9",
								"updated": "20250327172928"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "人机交互设备（字符设备-不可寻址）主要就是实现用户与计算机系统之间的通信。在输入输出时通常采用中断驱动的方式。例如：打印机、键盘鼠标等"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-ls2oiog",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-ls2oiog",
				"updated": "20250327172948"
			},
			"Children": [
				{
					"ID": "20250327172924-te3cgd6",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250327172924-te3cgd6",
						"updated": "20250327172948"
					},
					"Children": [
						{
							"ID": "20250327172924-fzx29gy",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250327172924-fzx29gy",
								"updated": "20250327172948"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "网络通信设备，要用于与远程设备进行通信。例如：网卡、调制解调器等"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-qfwrcnk",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20250327012435-qfwrcnk",
				"updated": "20250327173143"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "2. I/O设备与CPU连接图"
				}
			]
		},
		{
			"ID": "20250327012435-bhb8uvl",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-bhb8uvl",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "https://i-blog.csdnimg.cn/blog_migrate/7b908ef9b8647d29533eed457fb41690.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20250327012435-u4vhnef",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-u4vhnef",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\t通常I/O设备并不会直接与CPU进行通信，而是依靠设备控制器通信来实现通信（设备控制器位于计算机本身内部，集成在主板上，包含一些寄存器）"
				}
			]
		},
		{
			"ID": "20250327012435-i1fqa9f",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-i1fqa9f",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "设备控制器的作用"
				}
			]
		},
		{
			"ID": "20250327173140-l5u9jm8",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327173140-l5u9jm8",
				"updated": "20250327173143"
			},
			"Children": [
				{
					"ID": "20250327173143-a3rwrxw",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250327173143-a3rwrxw",
						"updated": "20250327173143"
					},
					"Children": [
						{
							"ID": "20250327173143-m3iu7po",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250327173143-m3iu7po",
								"updated": "20250327173143"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "接收设备的CPU指令（CPU的读写指令和参数存储在控制寄存器中）"
								}
							]
						}
					]
				},
				{
					"ID": "20250327173145-nb17ygc",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250327173145-nb17ygc",
						"updated": "20250327173145"
					},
					"Children": [
						{
							"ID": "20250327173145-n86vjop",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250327173145-n86vjop",
								"updated": "20250327173145"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "向CPU报告设备的状态（状态寄存器记录I/O设备的当前状态）"
								}
							]
						}
					]
				},
				{
					"ID": "20250327173147-hpf4ryy",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250327173147-hpf4ryy",
						"updated": "20250327173147"
					},
					"Children": [
						{
							"ID": "20250327173147-jkuy4s8",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250327173147-jkuy4s8",
								"updated": "20250327173147"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "进行数据交换（通过数据寄存器暂存CPU发来的数据和IO设备发来的数据，之后将数据发送给控制寄存器或CPU）"
								}
							]
						}
					]
				},
				{
					"ID": "20250327173149-ulcx69z",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250327173149-ulcx69z",
						"updated": "20250327173149"
					},
					"Children": [
						{
							"ID": "20250327173149-l04lfgx",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250327173149-l04lfgx",
								"updated": "20250327173149"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "地址识别（通过可寻址存储或队列根据CPU提供的地址来判断CPU要读取的是哪个IO设备）"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-nyazb1q",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20250327012435-nyazb1q",
				"updated": "20250327012435"
			}
		},
		{
			"ID": "20250327012435-05k8xpg",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20250327012435-05k8xpg",
				"updated": "20250328013457"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "3. CPU与I/O设备的交互"
				}
			]
		},
		{
			"ID": "20250327012435-b7uxn0r",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-b7uxn0r",
				"updated": "20250327173454"
			},
			"Children": [
				{
					"ID": "20250327173454-joq48el",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250327173454-joq48el",
						"updated": "20250327173454"
					},
					"Children": [
						{
							"ID": "20250327173454-zjtqofb",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250327173454-zjtqofb",
								"updated": "20250327173454"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": " "
								},
								{
									"Type": "NodeTextMark",
									"TextMarkType": "strong",
									"TextMarkTextContent": "在一次完整的CPU与IO设备的交互中，有三个重要的部分"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-jb1r6l5",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-jb1r6l5",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": " \tCPU访问I/O设备，CPU与I/O设备进行数据交换，I/O设备将结果返回给CPU"
				}
			]
		},
		{
			"ID": "20250327173502-72sldvb",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327173502-72sldvb",
				"updated": "20250328012630"
			},
			"Children": [
				{
					"ID": "20250327173502-l7kkxig",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "LQ=="
					},
					"Properties": {
						"id": "20250327173502-l7kkxig",
						"updated": "20250328012630"
					},
					"Children": [
						{
							"ID": "20250327012435-xp03ins",
							"Type": "NodeHeading",
							"HeadingLevel": 3,
							"Properties": {
								"id": "20250327012435-xp03ins",
								"updated": "20250328012630"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "访问I/O设备（IO Access）"
								}
							]
						},
						{
							"ID": "20250327173516-8k6m29t",
							"Type": "NodeList",
							"ListData": {},
							"Properties": {
								"id": "20250327173516-8k6m29t",
								"updated": "20250328012630"
							},
							"Children": [
								{
									"ID": "20250327173517-yb1hj6d",
									"Type": "NodeListItem",
									"ListData": {
										"BulletChar": 42,
										"Marker": "Kg=="
									},
									"Properties": {
										"id": "20250327173517-yb1hj6d",
										"style": "--en-bullet-line-height: 38.203125px;",
										"updated": "20250327173517"
									},
									"Children": [
										{
											"ID": "20250327173517-s874tt6",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250327173517-s874tt6",
												"updated": "20250327173719"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "访问I/O设备目前主要有两种方式"
												},
												{
													"Type": "NodeTextMark",
													"Properties": {
														"style": "background-color: var(--b3-card-error-background); color: var(--b3-card-error-color);"
													},
													"TextMarkType": "strong text",
													"TextMarkTextContent": "PMIO和MMIO"
												},
												{
													"Type": "NodeKramdownSpanIAL",
													"Data": "{: style=\"background-color: var(--b3-card-error-background); color: var(--b3-card-error-color);\"}"
												},
												{
													"Type": "NodeText",
													"Data": "，设备控制器上有一组IO寄存器, CPU通过访问IO寄存器就可以对IO设备进行相应的操作，两种不同的方式其区别就是找到IO寄存器的方式不同"
												}
											]
										}
									]
								},
								{
									"ID": "20250327173652-9qabuwb",
									"Type": "NodeListItem",
									"ListData": {
										"BulletChar": 42,
										"Marker": "Kg=="
									},
									"Properties": {
										"id": "20250327173652-9qabuwb",
										"style": "--en-bullet-line-height: 102.203125px;",
										"updated": "20250327173652"
									},
									"Children": [
										{
											"ID": "20250327173652-m89wkex",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250327173652-m89wkex",
												"updated": "20250327173652"
											},
											"Children": [
												{
													"Type": "NodeTextMark",
													"TextMarkType": "strong",
													"TextMarkTextContent": "PMIO端口映射IO（Port Mapped IO）"
												}
											]
										},
										{
											"ID": "20250327173828-1mc3l93",
											"Type": "NodeList",
											"ListData": {},
											"Properties": {
												"id": "20250327173828-1mc3l93",
												"updated": "20250327173830"
											},
											"Children": [
												{
													"ID": "20250327173830-g9awhkp",
													"Type": "NodeListItem",
													"ListData": {
														"BulletChar": 42,
														"Marker": "Kg=="
													},
													"Properties": {
														"id": "20250327173830-g9awhkp",
														"style": "--en-bullet-line-height: 38px;",
														"updated": "20250327173830"
													},
													"Children": [
														{
															"ID": "20250327173830-kelfaal",
															"Type": "NodeParagraph",
															"Properties": {
																"id": "20250327173830-kelfaal",
																"updated": "20250327173830"
															},
															"Children": [
																{
																	"Type": "NodeText",
																	"Data": "将I/O设备独立看待，使用CPU提供的专用I/O指令访问I/O设备"
																}
															]
														}
													]
												},
												{
													"ID": "20250327173833-xt3qg9y",
													"Type": "NodeListItem",
													"ListData": {
														"BulletChar": 42,
														"Marker": "Kg=="
													},
													"Properties": {
														"id": "20250327173833-xt3qg9y",
														"style": "--en-bullet-line-height: 76px;",
														"updated": "20250327173833"
													},
													"Children": [
														{
															"ID": "20250327173833-6ur05na",
															"Type": "NodeParagraph",
															"Properties": {
																"id": "20250327173833-6ur05na",
																"updated": "20250327173833"
															},
															"Children": [
																{
																	"Type": "NodeText",
																	"Data": "设备控制器的寄存器上映射了一组IO端口（这些IO端口存储在设备控制器中，不占用内存地址），CPU就可以通过一些特殊的指令来访问这些端口，从而达到访问IO寄存器的效果，最后达到对IO设备进行操作的目的"
																}
															]
														},
														{
															"ID": "20250327173837-bag30bt",
															"Type": "NodeList",
															"ListData": {},
															"Properties": {
																"id": "20250327173837-bag30bt",
																"updated": "20250327173842"
															},
															"Children": [
																{
																	"ID": "20250327173842-sp1yx85",
																	"Type": "NodeListItem",
																	"ListData": {
																		"BulletChar": 42,
																		"Marker": "Kg=="
																	},
																	"Properties": {
																		"id": "20250327173842-sp1yx85",
																		"style": "--en-bullet-line-height: 64px;",
																		"updated": "20250327173842"
																	},
																	"Children": [
																		{
																			"ID": "20250327173842-ii6kotu",
																			"Type": "NodeParagraph",
																			"Properties": {
																				"id": "20250327173842-ii6kotu",
																				"updated": "20250327173842"
																			},
																			"Children": [
																				{
																					"Type": "NodeText",
																					"Data": "优点：使用专门的IO指令对端口进行操作，IO指令短，执行速度快"
																				}
																			]
																		}
																	]
																},
																{
																	"ID": "20250327173850-ox9g5fm",
																	"Type": "NodeListItem",
																	"ListData": {
																		"BulletChar": 42,
																		"Marker": "Kg=="
																	},
																	"Properties": {
																		"id": "20250327173850-ox9g5fm",
																		"style": "--en-bullet-line-height: 102px;",
																		"updated": "20250327173850"
																	},
																	"Children": [
																		{
																			"ID": "20250327173850-i97mil0",
																			"Type": "NodeParagraph",
																			"Properties": {
																				"id": "20250327173850-i97mil0",
																				"updated": "20250327173850"
																			},
																			"Children": [
																				{
																					"Type": "NodeText",
																					"Data": "缺点：CPU需要设计单独的指令，实现复杂；不能使用通用的内存访问指令操作"
																				}
																			]
																		}
																	]
																}
															]
														}
													]
												}
											]
										}
									]
								},
								{
									"ID": "20250327173855-khdxrnt",
									"Type": "NodeListItem",
									"ListData": {
										"BulletChar": 42,
										"Marker": "Kg=="
									},
									"Properties": {
										"id": "20250327173855-khdxrnt",
										"style": "--en-bullet-line-height: 318.203125px;",
										"updated": "20250328012630"
									},
									"Children": [
										{
											"ID": "20250327173855-75z8qtg",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250327173855-75z8qtg",
												"updated": "20250327173855"
											},
											"Children": [
												{
													"Type": "NodeTextMark",
													"TextMarkType": "strong",
													"TextMarkTextContent": "MIMI内存映射IO（Memory Mapped IO）"
												}
											]
										},
										{
											"ID": "20250328012627-xb44h7w",
											"Type": "NodeList",
											"ListData": {},
											"Properties": {
												"id": "20250328012627-xb44h7w",
												"updated": "20250328012630"
											},
											"Children": [
												{
													"ID": "20250328012630-nceeuyd",
													"Type": "NodeListItem",
													"ListData": {
														"BulletChar": 42,
														"Marker": "Kg=="
													},
													"Properties": {
														"id": "20250328012630-nceeuyd",
														"style": "--en-bullet-line-height: 38px;",
														"updated": "20250328012630"
													},
													"Children": [
														{
															"ID": "20250328012630-1k9q6pt",
															"Type": "NodeParagraph",
															"Properties": {
																"id": "20250328012630-1k9q6pt",
																"updated": "20250328012630"
															},
															"Children": [
																{
																	"Type": "NodeText",
																	"Data": "物理内存和I/O设备共享物理内存地址空间，直接访问内存地址访问I/O设备"
																}
															]
														}
													]
												},
												{
													"ID": "20250328012638-qhfvrtm",
													"Type": "NodeListItem",
													"ListData": {
														"BulletChar": 42,
														"Marker": "Kg=="
													},
													"Properties": {
														"id": "20250328012638-qhfvrtm",
														"updated": "20250328012638"
													},
													"Children": [
														{
															"ID": "20250328012638-6avonm9",
															"Type": "NodeParagraph",
															"Properties": {
																"id": "20250328012638-6avonm9",
																"updated": "20250328012638"
															},
															"Children": [
																{
																	"Type": "NodeText",
																	"Data": "将设备控制器上寄存器映射的一组IO端口映射为一些特殊的内存地址，CPU只需要访问这些特殊的内存地址的话则可以达到访问IO端口的效果，也就对设备进行了操作（操作系统内部也不需要执行特殊的指令，而只需要像正常的操作一样访问特殊的内存地址即可对IO设备进行操作）"
																}
															]
														}
													]
												}
											]
										}
									]
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-1cadom9",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-1cadom9",
				"updated": "20250327173617"
			},
			"Children": [
				{
					"ID": "20250327173617-oyzbhil",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250327173617-oyzbhil",
						"updated": "20250327173617"
					},
					"Children": [
						{
							"ID": "20250327173617-6j2jbea",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250327173617-6j2jbea",
								"updated": "20250327173617"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "strong",
									"TextMarkTextContent": "后续衍生出了PCI设备"
								}
							]
						},
						{
							"ID": "20250327173620-dl514lv",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250327173620-dl514lv",
								"updated": "20250327173623"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "PCI设备及其衍生的接口（如PCIE）主要服务于高速I/O设备-网卡和显卡等"
								}
							]
						}
					]
				},
				{
					"ID": "20250327173627-qqoqo7e",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250327173627-qqoqo7e",
						"updated": "20250327173627"
					},
					"Children": [
						{
							"ID": "20250327173627-zetlj1o",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250327173627-zetlj1o",
								"updated": "20250327173627"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "计算机既要访问设备管理器的寄存器，也要访问它们的内存"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-nfoob0i",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20250327012435-nfoob0i",
				"updated": "20250328013550"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "4. 数据传输（Data Tronhsfer）"
				}
			]
		},
		{
			"ID": "20250327012435-aqci4jr",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-aqci4jr",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\t数据传输目前主要有三种实现方式：传统的标准传输、引入中断的传输、DMA传输"
				}
			]
		},
		{
			"ID": "20250327012435-wkvacc4",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20250327012435-wkvacc4",
				"updated": "20250328013550"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "4.1 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "传统的标准交互（程序直接控制的方式）"
				}
			]
		},
		{
			"ID": "20250327012435-tmha35k",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-tmha35k",
				"updated": "20250328013527"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\tCPU通过发送IO指令来进行数据传输（以读取数据为例）"
				}
			]
		},
		{
			"ID": "20250327012435-3v377dn",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-3v377dn",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\tCPU通过PMIO或MMIO获得IO设备对应的状态寄存器，然后读取I/O设备的状态，如果是忙碌状态就继续轮询检查状态，如果是空闲状态，则从中数据寄存器中读取数据到CPU中；读到CPU后CPU还需要往内存中写入数据，写完后在执行下一套指令"
				}
			]
		},
		{
			"ID": "20250327012435-kzefsl4",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-kzefsl4",
				"updated": "20250328013540"
			},
			"Children": [
				{
					"ID": "20250328013540-xwogo7l",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250328013540-xwogo7l",
						"updated": "20250328013540"
					},
					"Children": [
						{
							"ID": "20250328013540-9zq3se2",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250328013540-9zq3se2",
								"updated": "20250328013540"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "优点：实现简单"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-xurazby",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-xurazby",
				"updated": "20250328013544"
			},
			"Children": [
				{
					"ID": "20250328013544-hywfo9t",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250328013544-hywfo9t",
						"updated": "20250328013544"
					},
					"Children": [
						{
							"ID": "20250328013544-fg2bgdy",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250328013544-fg2bgdy",
								"updated": "20250328013544"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "缺点：CPU和I/O设备只能串行化工作，CPU要一直轮巡检查，长期处于忙等的低效状态中"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-kig0q8w",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20250327012435-kig0q8w",
				"updated": "20250328013622"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "4.2 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "中断驱动的方式"
				}
			]
		},
		{
			"ID": "20250327012435-js8vgf8",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-js8vgf8",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\t通过允许I/O设备主动打断CPU的运行并请求服务来解放CPU（以读取数据为例）"
				}
			]
		},
		{
			"ID": "20250327012435-ewz6oz5",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-ewz6oz5",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\tCPU通过PMIO或MMIO获得IO设备对应的状态寄存器，然后读取I/O设备的状态，如果是忙碌状态则CPU先做自己的任务，当IO设备空闲时便发出中断请求信号，CPU感知到中断后就会把当前正在进行任务的相关计算数据保存下来，优先完成对I/O设备的处理，然后CPU将读取的数据在存入到内存中"
				}
			]
		},
		{
			"ID": "20250327012435-w7j49jm",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-w7j49jm",
				"updated": "20250328013611"
			},
			"Children": [
				{
					"ID": "20250328013611-qqfcgeb",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250328013611-qqfcgeb",
						"updated": "20250328013611"
					},
					"Children": [
						{
							"ID": "20250328013611-dw1sbx9",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250328013611-dw1sbx9",
								"updated": "20250328013611"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "优点：CPU和I/O设备可以并行工作，CPU利用率得到提升"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-a7rf9lt",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-a7rf9lt",
				"updated": "20250328013613"
			},
			"Children": [
				{
					"ID": "20250328013613-2jro0jr",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250328013613-2jro0jr",
						"updated": "20250328013613"
					},
					"Children": [
						{
							"ID": "20250328013613-1wi6872",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250328013613-1wi6872",
								"updated": "20250328013613"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "缺点：数据在硬件中的移动是通过CPU完成的，仍然会消耗较多的CPU时间"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-zxovhc6",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20250327012435-zxovhc6",
				"updated": "20250328013725"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "4.3 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "直接存储方式DMA（Direct Memory Access）"
				}
			]
		},
		{
			"ID": "20250327012435-pt1cf5j",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-pt1cf5j",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\t以上两种方式，数据在硬件中的移动是通过CPU完成的（CPU读取数据时先得到数据，然后再由CPU存入内存；I/O设备读取数据时也是由CPU作为中间人）"
				}
			]
		},
		{
			"ID": "20250327012435-phx94l4",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-phx94l4",
				"updated": "20250328013637"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\tDMA的数据流向是从IO设备直接放入内存，或从内存直接到IO设备，不需要使用CPU作为中间者，直接将CPU从I/O任务中解脱出来"
				}
			]
		},
		{
			"ID": "20250327012435-df3fxax",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-df3fxax",
				"updated": "20250328013714"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\t多了DMA控制器模块，CPU将需要读取数据告诉DMA控制器（想要读取数据的那一块，然后把数据读到哪个内存的哪个地址），然后DMA控制器就代替CPU和设备控制器进行交互完成读取的工作，并将读取的数据写入到内存中去，此时CPU就可以去做其他的事情，当DMA控制器得操作执行完成后，将产生中断请求信号，通知CPU读取任务完成。"
				}
			]
		},
		{
			"ID": "20250327012435-3scjbvc",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-3scjbvc",
				"updated": "20250328013720"
			},
			"Children": [
				{
					"ID": "20250328013720-qemw4ie",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250328013720-qemw4ie",
						"updated": "20250328013720"
					},
					"Children": [
						{
							"ID": "20250328013720-vfubl39",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250328013720-vfubl39",
								"updated": "20250328013720"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "优点：仅在开始和结束需要CPU干涉，CPU和利用率进一步提升"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-sf8yzq9",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-sf8yzq9",
				"updated": "20250328013725"
			},
			"Children": [
				{
					"ID": "20250328013725-an067oz",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250328013725-an067oz",
						"updated": "20250328013725"
					},
					"Children": [
						{
							"ID": "20250328013725-63tj0r5",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250328013725-63tj0r5",
								"updated": "20250328013725"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "缺点：CPU发出一条指令只能读或写一个或多个连续的数据块；如果读写的数据块不是连续存放的则CPU需要分别发送多条I/O指令，进行多次中断处理"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-avrk5zp",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20250327012435-avrk5zp",
				"updated": "20250328013754"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "4.4 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "通道控制方式"
				}
			]
		},
		{
			"ID": "20250327012435-sru8cv5",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-sru8cv5",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "通道值得是一种硬件，可以理解为低配版的CPU"
				}
			]
		},
		{
			"ID": "20250327012435-8x8z9ff",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-8x8z9ff",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "通道根据CPU的指令执行响应程序，只有完成一组数据块的读写后才会发出中断信号让CPU干预（也是直接有设备→内存或内存→设备）"
				}
			]
		},
		{
			"ID": "20250327012435-3an1zsl",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-3an1zsl",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "CPU的干预频率最低"
				}
			]
		},
		{
			"ID": "20250327012435-byjs617",
			"Type": "NodeTable",
			"TableAligns": [
				0,
				0,
				0,
				0
			],
			"Properties": {
				"colgroup": "|||",
				"id": "20250327012435-byjs617",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeTableHead",
					"Data": "thead",
					"Children": [
						{
							"Type": "NodeTableRow",
							"Data": "tr",
							"Children": [
								{
									"Type": "NodeTableCell",
									"Data": "th",
									"Children": [
										{
											"Type": "NodeTextMark",
											"TextMarkType": "strong",
											"TextMarkTextContent": "实现方式"
										}
									]
								},
								{
									"Type": "NodeTableCell",
									"Data": "th",
									"Children": [
										{
											"Type": "NodeTextMark",
											"TextMarkType": "strong",
											"TextMarkTextContent": "CPU"
										},
										{
											"Type": "NodeBr",
											"Data": "br"
										},
										{
											"Type": "NodeTextMark",
											"TextMarkType": "strong",
											"TextMarkTextContent": "干预频率"
										}
									]
								},
								{
									"Type": "NodeTableCell",
									"Data": "th",
									"Children": [
										{
											"Type": "NodeTextMark",
											"TextMarkType": "strong",
											"TextMarkTextContent": "每次I/O传输的单位"
										}
									]
								},
								{
									"Type": "NodeTableCell",
									"Data": "th",
									"Children": [
										{
											"Type": "NodeTextMark",
											"TextMarkType": "strong",
											"TextMarkTextContent": "数据流向"
										}
									]
								}
							]
						}
					]
				},
				{
					"Type": "NodeTableRow",
					"Data": "tr",
					"Children": [
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"Children": [
								{
									"Type": "NodeText",
									"Data": "程序直接控制方式"
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"Children": [
								{
									"Type": "NodeText",
									"Data": "极高"
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"Children": [
								{
									"Type": "NodeText",
									"Data": "字"
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"Children": [
								{
									"Type": "NodeText",
									"Data": "设备→CPU→内存"
								},
								{
									"Type": "NodeBr",
									"Data": "br"
								},
								{
									"Type": "NodeText",
									"Data": "内存→CPU→设备"
								}
							]
						}
					]
				},
				{
					"Type": "NodeTableRow",
					"Data": "tr",
					"Children": [
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"Children": [
								{
									"Type": "NodeText",
									"Data": "中断驱动方式"
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"Children": [
								{
									"Type": "NodeText",
									"Data": "高"
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"Children": [
								{
									"Type": "NodeText",
									"Data": "字"
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"Children": [
								{
									"Type": "NodeText",
									"Data": "设备→CPU→内存"
								},
								{
									"Type": "NodeBr",
									"Data": "br"
								},
								{
									"Type": "NodeText",
									"Data": "内存→CPU→设备"
								}
							]
						}
					]
				},
				{
					"Type": "NodeTableRow",
					"Data": "tr",
					"Children": [
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"Children": [
								{
									"Type": "NodeText",
									"Data": "DMA"
								},
								{
									"Type": "NodeBr",
									"Data": "br"
								},
								{
									"Type": "NodeText",
									"Data": "方式"
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"Children": [
								{
									"Type": "NodeText",
									"Data": "中"
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"Children": [
								{
									"Type": "NodeText",
									"Data": "块"
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"Children": [
								{
									"Type": "NodeText",
									"Data": "设备→内存"
								},
								{
									"Type": "NodeBr",
									"Data": "br"
								},
								{
									"Type": "NodeText",
									"Data": "内存→设备"
								}
							]
						}
					]
				},
				{
					"Type": "NodeTableRow",
					"Data": "tr",
					"Children": [
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"Children": [
								{
									"Type": "NodeText",
									"Data": "通道控制方式"
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"Children": [
								{
									"Type": "NodeText",
									"Data": "低"
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"Children": [
								{
									"Type": "NodeText",
									"Data": "一组块"
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"Children": [
								{
									"Type": "NodeText",
									"Data": "设备→内存"
								},
								{
									"Type": "NodeBr",
									"Data": "br"
								},
								{
									"Type": "NodeText",
									"Data": "内存→设备"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-3871tkd",
			"Type": "NodeThematicBreak",
			"Properties": {
				"id": "20250327012435-3871tkd",
				"updated": "20250327012435"
			}
		},
		{
			"ID": "20250327012435-4b8y3p1",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20250327012435-4b8y3p1",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "5、 I/O设备虚拟化技术"
				}
			]
		},
		{
			"ID": "20250327012435-9dkyb4c",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-9dkyb4c",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": " "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "虚拟化架构："
				},
				{
					"Type": "NodeText",
					"Data": "\n"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "a",
					"TextMarkAHref": "https://blog.csdn.net/m0_49864110/article/details/134151350?csdn_share_tail=%7B%22type%22%3A%22blog%22%2C%22rType%22%3A%22article%22%2C%22rId%22%3A%22134151350%22%2C%22source%22%3A%22m0_49864110%22%7D",
					"TextMarkATitle": "虚拟化的基础知识-CSDN博客",
					"TextMarkTextContent": "虚拟化的基础知识-CSDN博客"
				}
			]
		},
		{
			"ID": "20250327012435-0bewrk2",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20250327012435-0bewrk2",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "5.1 软件辅助全虚拟化"
				}
			]
		},
		{
			"ID": "20250327012435-g4mn2nw",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-g4mn2nw",
				"updated": "20250328014413"
			},
			"Children": [
				{
					"ID": "20250328014413-5y33ip9",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250328014413-5y33ip9",
						"updated": "20250328014413"
					},
					"Children": [
						{
							"ID": "20250328014413-jai6vxi",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250328014413-jai6vxi",
								"updated": "20250328014413"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "strong",
									"TextMarkTextContent": "核心思想"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-4r05j0t",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-4r05j0t",
				"updated": "20250328014639"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\t将I/O设备以一个虚拟设备的形式暴露给虚拟机，虚拟机操作系统内部看来他正在使用一个真实的物理设备；VMM截获虚拟机驱动程序对设备的访问，并进行设备模拟；VMM的设备模拟器需要仔细研究现实设备的接口定义和内部设计规范，然后通过软件的方式完全模拟I/O设备\n，显示设备具有哪些资源，设备模拟器就需要呈现出同样的资源"
				}
			]
		},
		{
			"ID": "20250327012435-pxqx4ai",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-pxqx4ai",
				"updated": "20250328014739"
			},
			"Children": [
				{
					"ID": "20250328014739-znk44a3",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250328014739-znk44a3",
						"updated": "20250328014739"
					},
					"Children": [
						{
							"ID": "20250328014739-czznabu",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250328014739-czznabu",
								"updated": "20250328014739"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "strong",
									"TextMarkTextContent": "访问设备"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-bybudz4",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-bybudz4",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\tCPU通过PCI总线与I/O设备连接，在CPU的视角下，每个设备就是一个PCI设备，而每一个PCI设备都有一组重要的寄存器，叫做基址寄存器，软件虚拟化是通过VMM模拟基地址寄存器给虚拟机使得虚拟机能够找到I/O设备"
				}
			]
		},
		{
			"ID": "20250327012435-cz044t3",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-cz044t3",
				"updated": "20250328014754"
			},
			"Children": [
				{
					"ID": "20250328014754-hce5djy",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250328014754-hce5djy",
						"updated": "20250328014754"
					},
					"Children": [
						{
							"ID": "20250328014754-001xkey",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250328014754-001xkey",
								"updated": "20250328014754"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "strong",
									"TextMarkTextContent": "访问拦截"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-ulyoons",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-ulyoons",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\t虚拟机CPU访问虚拟I/O设备的两种形式PMIO和MMIO"
				}
			]
		},
		{
			"ID": "20250327012435-pvjfus2",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-pvjfus2",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\tPMIO和MMIO找到设备对应的IO端口或内存地址都是通过基址寄存器完成的"
				}
			]
		},
		{
			"ID": "20250327012435-av1dh5y",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-av1dh5y",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "PMIO\n访问拦截"
				}
			]
		},
		{
			"ID": "20250327012435-vjp31no",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-vjp31no",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "CPU通过特殊指令访问IO端口，这些端口可以由VMM来屏蔽掉，一旦CPU要访问这些端口，CPU就会触发异常，退出虚拟机，由VMM接管，此时VMM就可以截获到这次IO请求"
				}
			]
		},
		{
			"ID": "20250327012435-6bykd88",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-6bykd88",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "MIMO\n访问拦截"
				}
			]
		},
		{
			"ID": "20250327012435-p0yl6qi",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-p0yl6qi",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "CPU通过内存特殊地址来访问IO端口，该内存特殊地址为GPA，我们需要将其映射为HPA；而GPA→HPA的映射是由VMM建立的，当虚拟机触发MMIO来访问这些IO特殊地址时，触发异常产生VM exit交给VMM处理，这时VMM就可以感知到虚拟机对IO设备的访问了，并拦截了此次访问请求"
				}
			]
		},
		{
			"ID": "20250327012435-ykfjtuj",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-ykfjtuj",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "设备模拟"
				}
			]
		},
		{
			"ID": "20250327012435-dogsguv",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-dogsguv",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "需要VMM来模拟设备的真实行为了，不同的IO设备类型模拟不同的行为"
				}
			]
		},
		{
			"ID": "20250327012435-v4zy49s",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-v4zy49s",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "在VMM层面，这些模拟的设备是一个基于本地文件系统的一个文件，而虚拟机对于整个磁盘的读写在经过VMM层就转化为了对这个文件某一位置的读写，在此过程中就涉及到数据传输（DMA为例子）"
				}
			]
		},
		{
			"ID": "20250327012435-de7b62p",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-de7b62p",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "VMM内部需要模拟DMA的功能，虚拟机的设备驱动会告诉该DMA要读取数据的信息（虚拟机告知DMA的是GPA地址，需要通过内存虚拟化将该GPA转为HPA地址），然后由VMM来模拟这个行为将数据从文件中读取出来写入到目标地址中"
				}
			]
		},
		{
			"ID": "20250327012435-wpm4nql",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-wpm4nql",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "当DMA数据传输完成之后，VMM产生中断（通过为虚拟机的vCPU注入一个中断），告知虚拟机内部这次IO请求的完成；然后由虚拟机内部的中断机制来完成IO请求剩余的中断处理"
				}
			]
		},
		{
			"ID": "20250327012435-8ix3orw",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-8ix3orw",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "此方式的特点"
				}
			]
		},
		{
			"ID": "20250327012435-ohbyrti",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-ohbyrti",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "虚拟机操作系统原有的驱动程序无需修改就可以驱动虚拟设备"
				}
			]
		},
		{
			"ID": "20250327012435-pmmj2zk",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-pmmj2zk",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "对虚拟机来说非常透明，无需考虑底层硬件的情况"
				}
			]
		},
		{
			"ID": "20250327012435-5laha7u",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-5laha7u",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "软件模拟效率较低，并且虚拟机发送出来的I/O请求需要虚拟机和VMM之间进行多次交互，产生巨大开销"
				}
			]
		},
		{
			"ID": "20250327012435-cufv52j",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-cufv52j",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "以KVM架构实现软件辅助全虚拟化的架构"
				}
			]
		},
		{
			"ID": "20250327012435-dekc6kp",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-dekc6kp",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "https://i-blog.csdnimg.cn/blog_migrate/8a66e0773f8ab7beb6518d61d7742fa8.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20250327012435-9gbqzh1",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-9gbqzh1",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "虚拟机发送I/O请求到虚拟机的设备驱动"
				}
			]
		},
		{
			"ID": "20250327012435-e0n0nx3",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-e0n0nx3",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "设备驱动发送的I/O设备操作请求被KVM模块中的I/O操作捕获代码捕获（不会直接发到物理设备上）"
				}
			]
		},
		{
			"ID": "20250327012435-6ac93at",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-6ac93at",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "KVM的I/O操作模块捕获到I/O请求后，把请求进行处理，将请求信息存放到I/O共享页"
				}
			]
		},
		{
			"ID": "20250327012435-gweoqeh",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-gweoqeh",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "QEMU程序从I/O共享页读取信息后，交由硬件模拟代码来模拟出本次I/O操作，然后将其转发给硬件，硬件将结果返回给QEMU程序"
				}
			]
		},
		{
			"ID": "20250327012435-2by6zsx",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-2by6zsx",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "QEMU程序将将结果放回到I/O共享页，并通知KVM模块中的I/O操作捕获代码"
				}
			]
		},
		{
			"ID": "20250327012435-ucqbpsq",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-ucqbpsq",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "KVM模块的捕获代码读取I/O共享页中的操作结果，将结果返回给虚拟机"
				}
			]
		},
		{
			"ID": "20250327012435-j8f3fhx",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20250327012435-j8f3fhx",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "5.2 半虚拟化"
				}
			]
		},
		{
			"ID": "20250327012435-uquaowf",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20250327012435-uquaowf",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "5.2.1 Virtio协议基本概念"
				}
			]
		},
		{
			"ID": "20250327012435-8rog5py",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-8rog5py",
				"updated": "20250408142309"
			},
			"Children": [
				{
					"ID": "20250408142309-f946dzk",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250408142309-f946dzk",
						"updated": "20250408142309"
					},
					"Children": [
						{
							"ID": "20250408142309-kh9pt43",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250408142309-kh9pt43",
								"updated": "20250408142309"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "strong",
									"TextMarkTextContent": "为什么提出Virtio协议"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-xidx8sz",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-xidx8sz",
				"updated": "20250408142328"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\tVirtio很好的定义了一套半虚拟化的架构，但并不是唯一的半虚拟化IO的技术，它的主要意义是简化和统一半虚拟化I/O的标准。"
				}
			]
		},
		{
			"ID": "20250327012435-k53q4p4",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-k53q4p4",
				"updated": "20250408142402"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\tVirtio半虚拟化作为当前KVM平台上主流的半虚拟化IO协议，在设备的资源高效利用和保持性能之间做到了一个较好的平衡；既能够利用半虚拟化的特点，在数据传输层面极大的提高IO的效率，又能够保持前后端的良好兼容"
				}
			]
		},
		{
			"ID": "20250327012435-9u8mwr1",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-9u8mwr1",
				"updated": "20250408142423"
			},
			"Children": [
				{
					"ID": "20250408142413-mv3pyfw",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250408142413-mv3pyfw",
						"updated": "20250408142423"
					},
					"Children": [
						{
							"ID": "20250408142413-6layh0y",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250408142413-6layh0y",
								"updated": "20250408142423"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "strong",
									"TextMarkTextContent": "其他半虚拟化协议"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-tz62qyh",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-tz62qyh",
				"updated": "20250408142417"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\tXen有自己的一套完整的半虚拟化IO的实现方案、VMware也有自己的一套半虚拟化实现方案"
				}
			]
		},
		{
			"ID": "20250327012435-0gfn7ry",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-0gfn7ry",
				"updated": "20250408142426"
			},
			"Children": [
				{
					"ID": "20250408142426-lo9k5fc",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250408142426-lo9k5fc",
						"updated": "20250408142426"
					},
					"Children": [
						{
							"ID": "20250408142426-grrjmy8",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250408142426-grrjmy8",
								"updated": "20250408142426"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "strong",
									"TextMarkTextContent": "Virtio协议的概念"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-77sss6q",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-77sss6q",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\tvirtio定义了一套典型的前后端架构，通过在虚拟机安装前端驱动（Front-end driver），在VMM安装后端驱动（Back-end）；前端将请求通过VMM提供的通信机制直接发给后端，后端处理完请求后再发回通知给前者，使得前后端直接通信"
				}
			]
		},
		{
			"ID": "20250327012435-h70uzxd",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-h70uzxd",
				"updated": "20250408142501"
			},
			"Children": [
				{
					"ID": "20250408142443-pz4ipbe",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250408142443-pz4ipbe",
						"updated": "20250408142501"
					},
					"Children": [
						{
							"ID": "20250408142443-92f3r80",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250408142443-92f3r80",
								"updated": "20250408142443"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "strong",
									"TextMarkTextContent": "前后端之间的通信可以分为两个层面"
								}
							]
						},
						{
							"ID": "20250408142500-7qmjnug",
							"Type": "NodeList",
							"ListData": {},
							"Properties": {
								"id": "20250408142500-7qmjnug",
								"updated": "20250408142501"
							},
							"Children": [
								{
									"ID": "20250408142501-yxmv8pr",
									"Type": "NodeListItem",
									"ListData": {
										"BulletChar": 42,
										"Marker": "Kg=="
									},
									"Properties": {
										"id": "20250408142501-yxmv8pr",
										"style": "--en-bullet-line-height: 38px;",
										"updated": "20250408142501"
									},
									"Children": [
										{
											"ID": "20250408142501-f2wayuz",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250408142501-f2wayuz",
												"updated": "20250408142501"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "控制层面"
												}
											]
										},
										{
											"ID": "20250408142620-rluhbei",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250408142620-rluhbei",
												"updated": "20250408142627"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "通过控制层面使得前后端在通信之前在某方面达成一致，还会做一些对于数据层面的配置（例如CPU发现设备、配置IO设备、管理IO设备等相关操作）"
												}
											]
										},
										{
											"ID": "20250408142639-xcoj3bm",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250408142639-xcoj3bm",
												"updated": "20250408142639"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "例如：由于软件不断更新，前后端之间的版本可能不一致，在新的版本中可能会有新的特性；为了达成一致，后端会将自己的特性集合发给前端，前端也会将这些特性与自己的特性进行对比，最后返回两者的交集，这样就可以确保在特性上达成一致。"
												}
											]
										}
									]
								},
								{
									"ID": "20250408142624-g8wepd6",
									"Type": "NodeListItem",
									"ListData": {
										"BulletChar": 42,
										"Marker": "Kg=="
									},
									"Properties": {
										"id": "20250408142624-g8wepd6",
										"style": "--en-bullet-line-height: 166px;",
										"updated": "20250408142624"
									},
									"Children": [
										{
											"ID": "20250408142624-rnk7edw",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250408142624-rnk7edw",
												"updated": "20250408142624"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "数据层面"
												}
											]
										}
									]
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-95om34f",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-95om34f",
				"updated": "20250408142657"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\t\t数据层面是为虚拟机和IO设备进行数据传输所服务的；可以对虚拟机和设备之间IO数据传输的相关数据与传输方式进行设定"
				}
			]
		},
		{
			"ID": "20250327012435-k8ynfgc",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-k8ynfgc",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\t在数据层面中定义了一个virtqueue数据传输结构来供前端和后端进行数据上的通信"
				}
			]
		},
		{
			"ID": "20250327012435-qxoe0cj",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20250327012435-qxoe0cj",
				"updated": "20250408165016"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "5.2.2  Virtqueue讲解"
				}
			]
		},
		{
			"ID": "20250408142238-exqlqx6",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250408142238-exqlqx6",
				"updated": "20250408142239"
			},
			"Children": [
				{
					"ID": "20250408142239-eiskm44",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250408142239-eiskm44",
						"updated": "20250408142239"
					},
					"Children": [
						{
							"ID": "20250408142239-k1zdsvj",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250408142239-k1zdsvj",
								"updated": "20250408142239"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "strong",
									"TextMarkTextContent": "什么是Virtqueue"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-hwmn9f2",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-hwmn9f2",
				"updated": "20250408164306"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\tVirtqueue是一个队列的抽象模型，前端驱动负责向virtqueue中插入一个个数据buffer，后端则负责处理这些buffer；每个buffer可以由一段或多段不连续的数据空间链接而成，每段数据空间可以有不同的读写权限用于不同的用途（即buffer的具体结构与IO设备类型相关）"
				}
			]
		},
		{
			"ID": "20250408164401-1xfyh83",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250408164401-1xfyh83",
				"updated": "20250408164448"
			},
			"Children": [
				{
					"ID": "20250408164405-6b77yi2",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250408164405-6b77yi2",
						"updated": "20250408164405"
					},
					"Children": [
						{
							"ID": "20250408164405-6dxhica",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250408164405-6dxhica",
								"updated": "20250408164405"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "strong",
									"TextMarkTextContent": "virtqueue模型如何实现前后端通信"
								}
							]
						}
					]
				},
				{
					"ID": "20250408164415-doq4re5",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250408164415-doq4re5",
						"updated": "20250408164448"
					},
					"Children": [
						{
							"ID": "20250408164415-wbe15tv",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250408164415-wbe15tv",
								"updated": "20250408164415"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "virtqueue需要支持5个接口来实现数据在虚拟机和宿主机之间的传输"
								}
							]
						},
						{
							"ID": "20250408164418-eftq6f4",
							"Type": "NodeList",
							"ListData": {},
							"Properties": {
								"id": "20250408164418-eftq6f4",
								"updated": "20250408164448"
							},
							"Children": [
								{
									"ID": "20250408164421-03zgd48",
									"Type": "NodeListItem",
									"ListData": {
										"BulletChar": 42,
										"Marker": "Kg=="
									},
									"Properties": {
										"id": "20250408164421-03zgd48",
										"style": "--en-bullet-line-height: 38px;",
										"updated": "20250408164421"
									},
									"Children": [
										{
											"ID": "20250408164421-3z7eopa",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250408164421-3z7eopa",
												"updated": "20250408164421"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "add_buf接口：向virtqueue中插入一个待处理的buffer"
												}
											]
										}
									]
								},
								{
									"ID": "20250408164424-38gkpqb",
									"Type": "NodeListItem",
									"ListData": {
										"BulletChar": 42,
										"Marker": "Kg=="
									},
									"Properties": {
										"id": "20250408164424-38gkpqb",
										"style": "--en-bullet-line-height: 76px;",
										"updated": "20250408164424"
									},
									"Children": [
										{
											"ID": "20250408164424-ymf704z",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250408164424-ymf704z",
												"updated": "20250408164429"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "kick接口：通知宿主机由新的buffer加入"
												}
											]
										}
									]
								},
								{
									"ID": "20250408164432-pq156c2",
									"Type": "NodeListItem",
									"ListData": {
										"BulletChar": 42,
										"Marker": "Kg=="
									},
									"Properties": {
										"id": "20250408164432-pq156c2",
										"style": "--en-bullet-line-height: 114px;",
										"updated": "20250408164432"
									},
									"Children": [
										{
											"ID": "20250408164432-mtfefmz",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250408164432-mtfefmz",
												"updated": "20250408164437"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "get_buf接口：从virtqueue中获取一个宿主机处理完成的buffer"
												}
											]
										}
									]
								},
								{
									"ID": "20250408164442-v0ptgpj",
									"Type": "NodeListItem",
									"ListData": {
										"BulletChar": 42,
										"Marker": "Kg=="
									},
									"Properties": {
										"id": "20250408164442-v0ptgpj",
										"updated": "20250408164448"
									},
									"Children": [
										{
											"ID": "20250408164442-opgo4vl",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250408164442-opgo4vl",
												"updated": "20250408164448"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "disable_cb和enable_cp接口：IO设备驱动中的关中断和开中断，用于设置在宿主机处理完一个buffer后是否会被调用"
												}
											]
										}
									]
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-y6muv4h",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-y6muv4h",
				"updated": "20250408164811"
			},
			"Children": [
				{
					"ID": "20250408164500-bxaprx8",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250408164500-bxaprx8",
						"updated": "20250408164811"
					},
					"Children": [
						{
							"ID": "20250408164500-aynacvk",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250408164500-aynacvk",
								"updated": "20250408164500"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "strong",
									"TextMarkTextContent": "virtio_ring的作用以及组成"
								}
							]
						},
						{
							"ID": "20250408164550-ut39tw2",
							"Type": "NodeList",
							"ListData": {},
							"Properties": {
								"id": "20250408164550-ut39tw2",
								"updated": "20250408164811"
							},
							"Children": [
								{
									"ID": "20250408164553-42c0ov8",
									"Type": "NodeListItem",
									"ListData": {
										"BulletChar": 42,
										"Marker": "Kg=="
									},
									"Properties": {
										"id": "20250408164553-42c0ov8",
										"style": "--en-bullet-line-height: 38px;",
										"updated": "20250408164811"
									},
									"Children": [
										{
											"ID": "20250408164553-ml6skjv",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250408164553-ml6skjv",
												"updated": "20250408164811"
											},
											"Children": [
												{
													"Type": "NodeTextMark",
													"TextMarkType": "strong",
													"TextMarkTextContent": "Virtqueue是数据传输的抽象模型，而"
												},
												{
													"Type": "NodeTextMark",
													"Properties": {
														"style": "background-color: var(--b3-card-error-background); color: var(--b3-card-error-color);"
													},
													"TextMarkType": "strong text",
													"TextMarkTextContent": "virtio_ving"
												},
												{
													"Type": "NodeKramdownSpanIAL",
													"Data": "{: style=\"background-color: var(--b3-card-error-background); color: var(--b3-card-error-color);\"}"
												},
												{
													"Type": "NodeTextMark",
													"TextMarkType": "strong",
													"TextMarkTextContent": "（也称为ving）是这个模型的一种高效实现方式"
												},
												{
													"Type": "NodeText",
													"Data": "，而ving主要由以下三个部分组成"
												}
											]
										},
										{
											"ID": "20250408164602-sr7920a",
											"Type": "NodeList",
											"ListData": {},
											"Properties": {
												"id": "20250408164602-sr7920a",
												"updated": "20250408164604"
											},
											"Children": [
												{
													"ID": "20250408164604-kzg7rzd",
													"Type": "NodeListItem",
													"ListData": {
														"BulletChar": 42,
														"Marker": "Kg=="
													},
													"Properties": {
														"id": "20250408164604-kzg7rzd",
														"style": "--en-bullet-line-height: 38px;",
														"updated": "20250408164604"
													},
													"Children": [
														{
															"ID": "20250408164604-qqqkau0",
															"Type": "NodeParagraph",
															"Properties": {
																"id": "20250408164604-qqqkau0",
																"updated": "20250408164610"
															},
															"Children": [
																{
																	"Type": "NodeText",
																	"Data": "描述符表项 "
																}
															]
														},
														{
															"ID": "20250408164646-3g667o1",
															"Type": "NodeParagraph",
															"Properties": {
																"id": "20250408164646-3g667o1",
																"updated": "20250408164646"
															},
															"Children": [
																{
																	"Type": "NodeText",
																	"Data": "首先virtqueue会给每个buffer分配一个描述符（描述buffer的地址、长度等），并且也会维护一个全局的表来记录这些描述符，这个表中包含描述符所描述的特性（也有可能多个buffer连成一个链表）"
																}
															]
														}
													]
												},
												{
													"ID": "20250408164614-dti3zhi",
													"Type": "NodeListItem",
													"ListData": {
														"BulletChar": 42,
														"Marker": "Kg=="
													},
													"Properties": {
														"id": "20250408164614-dti3zhi",
														"style": "--en-bullet-line-height: 140px;",
														"updated": "20250408164614"
													},
													"Children": [
														{
															"ID": "20250408164614-j1f83a4",
															"Type": "NodeParagraph",
															"Properties": {
																"id": "20250408164614-j1f83a4",
																"updated": "20250408164650"
															},
															"Children": [
																{
																	"Type": "NodeText",
																	"Data": "Available ring队列 "
																}
															]
														},
														{
															"ID": "20250408164653-as2ar4g",
															"Type": "NodeParagraph",
															"Properties": {
																"id": "20250408164653-as2ar4g",
																"updated": "20250408164653"
															},
															"Children": [
																{
																	"Type": "NodeText",
																	"Data": "这个队列主要就是来表示在描述表里面有哪些请求是需要被处理的，需要将其在描述表中对应的序列号放入此队列（如果序号之间存在链接，则只放第一个序号）"
																}
															]
														}
													]
												},
												{
													"ID": "20250408164621-v0yyvg3",
													"Type": "NodeListItem",
													"ListData": {
														"BulletChar": 42,
														"Marker": "Kg=="
													},
													"Properties": {
														"id": "20250408164621-v0yyvg3",
														"style": "--en-bullet-line-height: 192px;",
														"updated": "20250408164621"
													},
													"Children": [
														{
															"ID": "20250408164621-z80chb7",
															"Type": "NodeParagraph",
															"Properties": {
																"id": "20250408164621-z80chb7",
																"updated": "20250408164623"
															},
															"Children": [
																{
																	"Type": "NodeText",
																	"Data": "Used ring队列"
																}
															]
														},
														{
															"ID": "20250408164627-j9s7fi9",
															"Type": "NodeParagraph",
															"Properties": {
																"id": "20250408164627-j9s7fi9",
																"updated": "20250408164627"
															},
															"Children": [
																{
																	"Type": "NodeText",
																	"Data": "后端处理完成后会将处理好的请求放到该队列中，这个队列的格式和Available Ring是差不多的，也是把相应的描述符在描述表中对应的序号填写进去（如果后端往buffer里面写过数据，它同样会带上她在buffer里面写入数据的长度）"
																}
															]
														}
													]
												}
											]
										}
									]
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-3a2b8k1",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-3a2b8k1",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "https://i-blog.csdnimg.cn/blog_migrate/ae55756ef027b27145ad64cd0fdfaa10.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20250327012435-mmu3to0",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-mmu3to0",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "https://i-blog.csdnimg.cn/blog_migrate/4bf146d4f6bb0ce711b79e109fbddf8a.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20250327012435-gxlsdcj",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-gxlsdcj",
				"updated": "20250408164816"
			},
			"Children": [
				{
					"ID": "20250408164816-ick8sym",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250408164816-ick8sym",
						"updated": "20250408164816"
					},
					"Children": [
						{
							"ID": "20250408164816-8zgdg59",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250408164816-8zgdg59",
								"updated": "20250408164816"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "strong",
									"TextMarkTextContent": "工作流程"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-kpkh1e4",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20250327012435-kpkh1e4",
				"updated": "20250408164947"
			},
			"Children": [
				{
					"ID": "20250408164947-pnfu4w5",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "MS4=",
						"Num": 1
					},
					"Properties": {
						"id": "20250408164947-pnfu4w5",
						"updated": "20250408164947"
					},
					"Children": [
						{
							"ID": "20250408164947-rrepfc1",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250408164947-rrepfc1",
								"updated": "20250408164947"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "假如前端发送了一个IO读取的请求，则前端通过add"
								},
								{
									"Type": "NodeBackslash",
									"Data": "span",
									"Children": [
										{
											"Type": "NodeText",
											"Data": "_"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "buf接口在virtqueue中插入一个buffer，并且接下来会往描述符表项中写入关于这一个buffer的描述符（包含地址、长度、序号等信息）"
								}
							]
						}
					]
				},
				{
					"ID": "20250408164950-pvoa6e8",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "Mi4=",
						"Num": 2
					},
					"Properties": {
						"id": "20250408164950-pvoa6e8",
						"updated": "20250408164950"
					},
					"Children": [
						{
							"ID": "20250408164950-p7ufh53",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250408164950-p7ufh53",
								"updated": "20250408164950"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "然后此buffer描述符对应的序列号加入到Available Ring队列，此时前端就会通过virtqueue提供的kick接口来告知后端设备这些请求是需要处理的"
								}
							]
						}
					]
				},
				{
					"ID": "20250408164953-87xo1ac",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "My4=",
						"Num": 3
					},
					"Properties": {
						"id": "20250408164953-87xo1ac",
						"updated": "20250408164953"
					},
					"Children": [
						{
							"ID": "20250408164953-71c5lft",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250408164953-71c5lft",
								"updated": "20250408164953"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "然后后端设备将会从Available Ring队列里面读取请求来处理（当然这个kick也会涉及到一次vm-exit）"
								}
							]
						}
					]
				},
				{
					"ID": "20250408164957-iqazmzk",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "NC4=",
						"Num": 4
					},
					"Properties": {
						"id": "20250408164957-iqazmzk",
						"updated": "20250408164957"
					},
					"Children": [
						{
							"ID": "20250408164957-kren9be",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250408164957-kren9be",
								"updated": "20250408164957"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "后端处理完成后会将处理好的请求放到Used Ring队列（也是把相应的描述符在描述表项中的对应序号填写进去），然后会以一个正常的中断形式注入给虚拟机，告知其内部I/O操作完成"
								}
							]
						}
					]
				},
				{
					"ID": "20250408164959-dehazco",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "NS4=",
						"Num": 5
					},
					"Properties": {
						"id": "20250408164959-dehazco",
						"updated": "20250408164959"
					},
					"Children": [
						{
							"ID": "20250408164959-7j310bw",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250408164959-7j310bw",
								"updated": "20250408164959"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "然后前端通过get"
								},
								{
									"Type": "NodeBackslash",
									"Data": "span",
									"Children": [
										{
											"Type": "NodeText",
											"Data": "_"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "buf接口从virtqueue中的Used Ring队列获取宿主机处理完成的buffer"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-1x8p2wk",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-1x8p2wk",
				"updated": "20250408165016"
			},
			"Children": [
				{
					"ID": "20250408165002-oy2z7km",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250408165002-oy2z7km",
						"updated": "20250408165016"
					},
					"Children": [
						{
							"ID": "20250408165002-xfb3e3e",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250408165002-xfb3e3e",
								"updated": "20250408165002"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "strong",
									"TextMarkTextContent": "特点"
								}
							]
						},
						{
							"ID": "20250408165015-sh5za4u",
							"Type": "NodeList",
							"ListData": {},
							"Properties": {
								"id": "20250408165015-sh5za4u",
								"updated": "20250408165016"
							},
							"Children": [
								{
									"ID": "20250408165016-chf2gsn",
									"Type": "NodeListItem",
									"ListData": {
										"BulletChar": 42,
										"Marker": "Kg=="
									},
									"Properties": {
										"id": "20250408165016-chf2gsn",
										"style": "--en-bullet-line-height: 38px;",
										"updated": "20250408165016"
									},
									"Children": [
										{
											"ID": "20250408165016-g2gcujr",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250408165016-g2gcujr",
												"updated": "20250408165016"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "需要修改虚拟机和宿主机操作系统内核相应的代码来满足相应要求，兼容性较低"
												}
											]
										}
									]
								},
								{
									"ID": "20250408165018-pwlos7o",
									"Type": "NodeListItem",
									"ListData": {
										"BulletChar": 42,
										"Marker": "Kg=="
									},
									"Properties": {
										"id": "20250408165018-pwlos7o",
										"style": "--en-bullet-line-height: 76px;",
										"updated": "20250408165018"
									},
									"Children": [
										{
											"ID": "20250408165018-rr8a8w5",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250408165018-rr8a8w5",
												"updated": "20250408165018"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "省略了我们在发送I/O前先进行VMM捕获的过程，使用效率提升"
												}
											]
										}
									]
								},
								{
									"ID": "20250408165024-2wjapq6",
									"Type": "NodeListItem",
									"ListData": {
										"BulletChar": 42,
										"Marker": "Kg=="
									},
									"Properties": {
										"id": "20250408165024-2wjapq6",
										"updated": "20250408165024"
									},
									"Children": [
										{
											"ID": "20250408165024-9i2i135",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250408165024-9i2i135",
												"updated": "20250408165024"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "支持前端在Available Ring中设置让后端知道什么时候能够触发一个中断，也可以在后端Used Ring中设置前端的下一次Kick是什么时候"
												}
											]
										}
									]
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-fllknrj",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-fllknrj",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "以KVM架构实现半虚拟化的架构"
				}
			]
		},
		{
			"ID": "20250327012435-4x4y848",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-4x4y848",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "https://i-blog.csdnimg.cn/blog_migrate/5ea8c9c4a8603db18156a2ff32d4bfbd.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20250327012435-hlifvbh",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-hlifvbh",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "不过常用的半虚拟化架构为Xen架构"
				}
			]
		},
		{
			"ID": "20250327012435-auc2kx9",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20250327012435-auc2kx9",
				"updated": "20250408142128"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "5.3 硬件辅助全虚拟化"
				}
			]
		},
		{
			"ID": "20250327012435-h0czrjx",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-h0czrjx",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": " "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "目前常用的有两种方式"
				}
			]
		},
		{
			"ID": "20250327012435-15jb7li",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-15jb7li",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": " I/O直通方式（设备透传方式）、SR-IOV方式"
				}
			]
		},
		{
			"ID": "20250327012435-s3bipux",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20250327012435-s3bipux",
				"updated": "20250401150149"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "5.4.1 I/O直通方式"
				}
			]
		},
		{
			"ID": "20250327012435-vcfiy6u",
			"Type": "NodeHeading",
			"HeadingLevel": 4,
			"Properties": {
				"id": "20250327012435-vcfiy6u",
				"updated": "20250401150149"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "5.4.1.1 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "核心思想"
				}
			]
		},
		{
			"ID": "20250401150147-w5t3w93",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250401150147-w5t3w93",
				"updated": "20250401150149"
			},
			"Children": [
				{
					"ID": "20250401150149-feyf5aq",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250401150149-feyf5aq",
						"updated": "20250401150149"
					},
					"Children": [
						{
							"ID": "20250401150149-ozttnv1",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250401150149-ozttnv1",
								"updated": "20250401150149"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "虚拟机真正直接使用到了物理设备，给物理服务器安装多个I/O设备，将一个物理I/O设备直通给虚拟机使用，使得虚拟机操作系统可以直接操作这个I/O设备，尽量避免触发VM exit来让VMM介入（最常用的就是网卡--直通网卡）"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-1t9f5tr",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-1t9f5tr",
				"updated": "20250401150152"
			},
			"Children": [
				{
					"ID": "20250401150152-pki7olv",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250401150152-pki7olv",
						"updated": "20250401150152"
					},
					"Children": [
						{
							"ID": "20250401150152-k3ne4p7",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250401150152-k3ne4p7",
								"updated": "20250401150152"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "I/O直通技术需要硬件支持才可以完成，首选的是Inter的VT-d技术（还有包括VMDq、IOMMU技术等）"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250401145954-kmk7vn9",
			"Type": "NodeHeading",
			"HeadingLevel": 4,
			"Properties": {
				"id": "20250401145954-kmk7vn9",
				"updated": "20250401155057"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "5.4.1.2 设备访问"
				}
			]
		},
		{
			"ID": "20250327012435-7rcetjs",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-7rcetjs",
				"updated": "20250401150258"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\t我们要知道PMIO和MMIO找到设备对应的IO端口或内存地址都是通过PCI设备的基址寄存器完成的。因此在直通的情况下，虽然物理设备直接存在，但是不能直接把物理设备的基址寄存器暴露给虚拟机，因为在设备透传给虚拟机之前，该I/O设备还需要挂载给物理主机，因此该I/O设备的基址寄存器实际上是宿主机配置的而不是虚拟机，如果直接将I/O的基址寄存器直接暴露给虚拟机，可能会存在基址寄存器冲突，因此在物理设备透传的情况下，我们也需要模拟寄存器给虚拟机"
				}
			]
		},
		{
			"ID": "20250327012435-7qfz29e",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-7qfz29e",
				"updated": "20250401150337"
			},
			"Children": [
				{
					"ID": "20250401150330-upn64zu",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250401150330-upn64zu",
						"updated": "20250401150337"
					},
					"Children": [
						{
							"ID": "20250401150330-2jx26p5",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250401150330-2jx26p5",
								"updated": "20250401150330"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "strong",
									"TextMarkTextContent": "访问拦截"
								}
							]
						},
						{
							"ID": "20250401150336-rjmdm2y",
							"Type": "NodeList",
							"ListData": {},
							"Properties": {
								"id": "20250401150336-rjmdm2y",
								"updated": "20250401150337"
							},
							"Children": [
								{
									"ID": "20250401150337-957jfan",
									"Type": "NodeListItem",
									"ListData": {
										"BulletChar": 42,
										"Marker": "Kg=="
									},
									"Properties": {
										"id": "20250401150337-957jfan",
										"style": "--en-bullet-line-height: 38px;",
										"updated": "20250401150337"
									},
									"Children": [
										{
											"ID": "20250401150337-yla4z2w",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250401150337-yla4z2w",
												"updated": "20250401150337"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "PMIO方式的访问拦截"
												}
											]
										},
										{
											"ID": "20250401150512-gizr3cg",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250401150512-gizr3cg",
												"updated": "20250401150512"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "虚拟机的基址寄存器是不同于物理机的基址寄存器的，因此他们的IO端口可能就是不同的，所以当虚拟机访问自己的IO端口时VMM需要将其截获，并且将这个IO请求转发给物理设备真实的IO端口，此时就会涉及到依次VM exit"
												}
											]
										}
									]
								},
								{
									"ID": "20250401150516-8fsyfh0",
									"Type": "NodeListItem",
									"ListData": {
										"BulletChar": 42,
										"Marker": "Kg=="
									},
									"Properties": {
										"id": "20250401150516-8fsyfh0",
										"style": "--en-bullet-line-height: 140px;",
										"updated": "20250401150516"
									},
									"Children": [
										{
											"ID": "20250401150516-bfc4wvm",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250401150516-bfc4wvm",
												"updated": "20250401150516"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "MMIO方式的访问拦截"
												}
											]
										},
										{
											"ID": "20250401150525-pyoxt8p",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250401150525-pyoxt8p",
												"updated": "20250401150525"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "MMIO下虚拟机访问IO设备直接访问的就是一个内存地址，这个内存地址为GPA，然后通过内存虚拟化将GPA转为HPA；对于IO设备也是需要在VMM上建立IO GPA到IO HPA的映射关系，使得虚拟机访问IO设备就可以直接通过映射表来完成"
												}
											]
										}
									]
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-p9a6z6q",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-p9a6z6q",
				"updated": "20250401155048"
			},
			"Children": [
				{
					"ID": "20250401150334-hntfy54",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250401150334-hntfy54",
						"updated": "20250401155048"
					},
					"Children": [
						{
							"ID": "20250401150334-xg0zq0v",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250401150334-xg0zq0v",
								"updated": "20250401150826"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"Properties": {
										"style": "background-color: var(--b3-card-error-background); color: var(--b3-card-error-color);"
									},
									"TextMarkType": "strong text",
									"TextMarkTextContent": "数据传输"
								},
								{
									"Type": "NodeKramdownSpanIAL",
									"Data": "{: style=\"background-color: var(--b3-card-error-background); color: var(--b3-card-error-color);\"}"
								}
							]
						},
						{
							"ID": "20250401150817-dyp2h8w",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250401150817-dyp2h8w",
								"updated": "20250401150823"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "strong",
									"TextMarkTextContent": "DMA重映射"
								}
							]
						},
						{
							"ID": "20250401155047-nrdwmqi",
							"Type": "NodeList",
							"ListData": {},
							"Properties": {
								"id": "20250401155047-nrdwmqi",
								"updated": "20250401155048"
							},
							"Children": [
								{
									"ID": "20250401155048-e6uh0b5",
									"Type": "NodeListItem",
									"ListData": {
										"BulletChar": 42,
										"Marker": "Kg=="
									},
									"Properties": {
										"id": "20250401155048-e6uh0b5",
										"style": "--en-bullet-line-height: 76px;",
										"updated": "20250401155048"
									},
									"Children": [
										{
											"ID": "20250401155048-se6ibg2",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250401155048-se6ibg2",
												"updated": "20250401155048"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "虚拟机内部的设备驱动是期待这个设备支持DMA功能的"
												}
											]
										}
									]
								},
								{
									"ID": "20250401155051-vjx3bxi",
									"Type": "NodeListItem",
									"ListData": {
										"BulletChar": 42,
										"Marker": "Kg=="
									},
									"Properties": {
										"id": "20250401155051-vjx3bxi",
										"updated": "20250401155051"
									},
									"Children": [
										{
											"ID": "20250401155051-fa3c3ry",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250401155051-fa3c3ry",
												"updated": "20250401155051"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "在DMA的视角下，它只知道虚拟内存的地址空间，它就会往虚拟地址中读写数据，但是实际上这个内存地址是错误的，应该写入的地址是物理机内存地址，因此就需要做到DMA的重映射，这个功能是由介于设备控制器和内存之间的一个模块（"
												},
												{
													"Type": "NodeTextMark",
													"TextMarkType": "strong",
													"TextMarkTextContent": "叫做IOMMU实现"
												},
												{
													"Type": "NodeText",
													"Data": "的，该模块属于CPU的功能）"
												}
											]
										}
									]
								}
							]
						}
					]
				},
				{
					"ID": "20250401150834-bae6f95",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250401150834-bae6f95",
						"updated": "20250401150935"
					},
					"Children": [
						{
							"ID": "20250401150834-82m4em9",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250401150834-82m4em9",
								"updated": "20250401150846"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"Properties": {
										"style": "background-color: var(--b3-card-error-background); color: var(--b3-card-error-color);"
									},
									"TextMarkType": "text",
									"TextMarkTextContent": "IOMMU介绍"
								},
								{
									"Type": "NodeKramdownSpanIAL",
									"Data": "{: style=\"background-color: var(--b3-card-error-background); color: var(--b3-card-error-color);\"}"
								}
							]
						},
						{
							"ID": "20250401150853-5putkrb",
							"Type": "NodeList",
							"ListData": {},
							"Properties": {
								"id": "20250401150853-5putkrb",
								"updated": "20250401150931"
							},
							"Children": [
								{
									"ID": "20250401150931-uu5yrzi",
									"Type": "NodeListItem",
									"ListData": {
										"BulletChar": 42,
										"Marker": "Kg=="
									},
									"Properties": {
										"id": "20250401150931-uu5yrzi",
										"style": "--en-bullet-line-height: 38px;",
										"updated": "20250401150931"
									},
									"Children": [
										{
											"ID": "20250401150931-etu1mb2",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250401150931-etu1mb2",
												"updated": "20250401150931"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "IOMMU是一个内存管理单元，主要针对外设访问系统内存时进行内存管理"
												}
											]
										}
									]
								}
							]
						},
						{
							"ID": "20250401150919-9ni6xc2",
							"Type": "NodeList",
							"ListData": {},
							"Properties": {
								"id": "20250401150919-9ni6xc2",
								"updated": "20250401150935"
							},
							"Children": [
								{
									"ID": "20250401150935-oo3rb1f",
									"Type": "NodeListItem",
									"ListData": {
										"BulletChar": 42,
										"Marker": "Kg=="
									},
									"Properties": {
										"id": "20250401150935-oo3rb1f",
										"updated": "20250401150935"
									},
									"Children": [
										{
											"ID": "20250401150935-ehnsqnr",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250401150935-ehnsqnr",
												"updated": "20250401150935"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "IOMMU的主要功能包括DMA Remapping（地址重映射）和Interrupt Remapping（中断重映射）"
												}
											]
										}
									]
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-wkw8kia",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-wkw8kia",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "对于DMA Remapping，IOMMU可以将一个设备访问地址转换为存储器地址（对于虚拟机的情况来说就是可以实现GPA与HPA的转换）"
				}
			]
		},
		{
			"ID": "20250327012435-qvpkfin",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-qvpkfin",
				"updated": "20250401155057"
			},
			"Children": [
				{
					"Type": "NodeTextMark",
					"TextMarkType": "inline-math",
					"TextMarkInlineMathContent": "即"
				},
				{
					"Type": "NodeText",
					"Data": "：在IOMMU中会有一个表项，这个表是通过一个一个的PCI设备来作为索引的，并且能够导向虚拟机的信息（包含IO GPA到IO HPA的映射信息），这个索引到虚拟机信息的映射是由负责分配虚拟机内存的VMM建立的"
				}
			]
		},
		{
			"ID": "20250327012435-im2cmrv",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-im2cmrv",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "具体IOMMU工作原理"
				}
			]
		},
		{
			"ID": "20250327012435-dzc7cpg",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-dzc7cpg",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "在整个PCI架构中，每个设备都是有自己的一个唯一的标识符，类似于身份证，我们叫做Src ID，当设备通过这个PCI总线进行通信的时候，会携带上自己的Src ID，而I/O设备和内存之间通信也一样"
				}
			]
		},
		{
			"ID": "20250327012435-9qgq80u",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-9qgq80u",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "当DMA发送请求时会被IOMMU给截获并找到对应PCI设备的Src id，然后通过IOMMU的映射就可以将这个DMA控制器所访问的GPA内存地址转换为HPA，从而DMA的操作也就可以访问到一个正确的内存地址了"
				}
			]
		},
		{
			"ID": "20250327012435-dx5udo8",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-dx5udo8",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "当DMA完成操作之后会产生中断信息，告诉虚拟机IO操作完成"
				}
			]
		},
		{
			"ID": "20250327012435-z9mx7jc",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-z9mx7jc",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "https://i-blog.csdnimg.cn/blog_migrate/7d9ea8231462c0c2dbf20ccfdc1f8a5a.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20250327012435-ipzk1pd",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-ipzk1pd",
				"updated": "20250401150031"
			},
			"Children": [
				{
					"ID": "20250401150013-y2i9nmd",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250401150013-y2i9nmd",
						"updated": "20250401150031"
					},
					"Children": [
						{
							"ID": "20250401150013-d1terc2",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250401150013-d1terc2",
								"updated": "20250401150013"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "strong",
									"TextMarkTextContent": "特点"
								}
							]
						},
						{
							"ID": "20250401150028-2ei6v2s",
							"Type": "NodeList",
							"ListData": {},
							"Properties": {
								"id": "20250401150028-2ei6v2s",
								"updated": "20250401150031"
							},
							"Children": [
								{
									"ID": "20250401150031-hnzxci1",
									"Type": "NodeListItem",
									"ListData": {
										"BulletChar": 42,
										"Marker": "Kg=="
									},
									"Properties": {
										"id": "20250401150031-hnzxci1",
										"style": "--en-bullet-line-height: 38px;",
										"updated": "20250401150031"
									},
									"Children": [
										{
											"ID": "20250401150031-glsfmro",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250401150031-glsfmro",
												"updated": "20250401150031"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "这种方式从性能上来说是最优先的，但这种方式需要比较多的硬件资源"
												}
											]
										}
									]
								},
								{
									"ID": "20250401150037-txvj9pe",
									"Type": "NodeListItem",
									"ListData": {
										"BulletChar": 42,
										"Marker": "Kg=="
									},
									"Properties": {
										"id": "20250401150037-txvj9pe",
										"updated": "20250401150037"
									},
									"Children": [
										{
											"ID": "20250401150037-lu6t3my",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250401150037-lu6t3my",
												"updated": "20250401150037"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "这种方式一旦一个设备被虚拟机占用了，其他虚拟机就无法使用该设备"
												}
											]
										}
									]
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-tzaudtk",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20250327012435-tzaudtk",
				"updated": "20250401145325"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "5.4.2 SR-IOV方式"
				}
			]
		},
		{
			"ID": "20250327012435-b2h24hy",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-b2h24hy",
				"updated": "20250401145243"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\t设备透传无法达到单个设备共享给多个虚拟机使用的目的，因为IO设备是依据挂载给单个主机使用而设计的；于是可以在IO设备设计时就考虑到将其运行在虚拟化环境中的，使得一个I/O设备支持共享给多个虚拟机来使用，这就是SR-IOV技术（还有其他类似技术包括MR-IOV、DDIO等技术）"
				}
			]
		},
		{
			"ID": "20250327012435-ar95cop",
			"Type": "NodeHeading",
			"HeadingLevel": 4,
			"Properties": {
				"id": "20250327012435-ar95cop",
				"updated": "20250401145325"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "5.4.2.1 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "SR-IOV的基本概念"
				}
			]
		},
		{
			"ID": "20250327012435-2ldi1bt",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-2ldi1bt",
				"updated": "20250401145321"
			},
			"Children": [
				{
					"ID": "20250401145321-qdopxtr",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250401145321-qdopxtr",
						"updated": "20250401145321"
					},
					"Children": [
						{
							"ID": "20250401145321-vk0omka",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250401145321-vk0omka",
								"updated": "20250401145321"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "在宿主机上挂载一个支持SR-IOV的高性能网络设备，需要CPU支持IOMMU"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-34xgdcq",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-34xgdcq",
				"updated": "20250401145325"
			},
			"Children": [
				{
					"ID": "20250401145325-sp34go7",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250401145325-sp34go7",
						"updated": "20250401145325"
					},
					"Children": [
						{
							"ID": "20250401145325-7ke49db",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250401145325-7ke49db",
								"updated": "20250401145325"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "SR-IOV是将设备的虚拟化放到了硬件层面来实现，从而减少了软件层面的开销"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-w7nugn5",
			"Type": "NodeHeading",
			"HeadingLevel": 4,
			"Properties": {
				"id": "20250327012435-w7nugn5",
				"updated": "20250401145814"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "5.4.2.2 "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "SR-IOV单独引入了两种软件实体功能"
				}
			]
		},
		{
			"ID": "20250327012435-4thuwbd",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-4thuwbd",
				"updated": "20250401145416"
			},
			"Children": [
				{
					"ID": "20250401145415-tcanrk8",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250401145415-tcanrk8",
						"updated": "20250401145416"
					},
					"Children": [
						{
							"ID": "20250401145415-nzy6nth",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250401145415-nzy6nth",
								"updated": "20250401145416"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "Physical Function（PF）"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-mzmej9h",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-mzmej9h",
				"updated": "20250401145507"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\tPF包含轻量级的PCIE功能， 一个PF能够作为一个PCIE设备来供这个宿主机所配置。"
				}
			]
		},
		{
			"ID": "20250401145508-uvzyb0m",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250401145508-uvzyb0m",
				"updated": "20250401145509"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "        一个SR-IOV设备上可能会有多个PF，本次只考虑单个PF的情况"
				}
			]
		},
		{
			"ID": "20250327012435-75w6lcg",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-75w6lcg",
				"updated": "20250401145522"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "       "
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "作用："
				},
				{
					"Type": "NodeText",
					"Data": "为虚拟机提供设备访问功能和全局贡献资源配置的功能"
				}
			]
		},
		{
			"ID": "20250327012435-gd37hbf",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-gd37hbf",
				"updated": "20250401145556"
			},
			"Children": [
				{
					"ID": "20250401145532-v5maxwm",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250401145532-v5maxwm",
						"updated": "20250401145556"
					},
					"Children": [
						{
							"ID": "20250401145532-orfdeh6",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250401145532-orfdeh6",
								"updated": "20250401145534"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "VF（Virtual Function）"
								}
							]
						},
						{
							"ID": "20250401145554-aweb8t0",
							"Type": "NodeList",
							"ListData": {},
							"Properties": {
								"id": "20250401145554-aweb8t0",
								"updated": "20250401145556"
							},
							"Children": [
								{
									"ID": "20250401145556-e60237d",
									"Type": "NodeListItem",
									"ListData": {
										"BulletChar": 42,
										"Marker": "Kg=="
									},
									"Properties": {
										"id": "20250401145556-e60237d",
										"style": "--en-bullet-line-height: 38px;",
										"updated": "20250401145556"
									},
									"Children": [
										{
											"ID": "20250401145556-ndmrw8p",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250401145556-ndmrw8p",
												"updated": "20250401145556"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "VF也包含轻量级的PCIE功能，我们可以将这个VF透传给一个虚拟机所使用，因此多个VF便可以拓展给不同的虚拟机，这样就可以达到将整个SR-IOV设备共享给多个虚拟机的目的"
												}
											]
										}
									]
								},
								{
									"ID": "20250401145601-n4utrab",
									"Type": "NodeListItem",
									"ListData": {
										"BulletChar": 42,
										"Marker": "Kg=="
									},
									"Properties": {
										"id": "20250401145601-n4utrab",
										"updated": "20250401145601"
									},
									"Children": [
										{
											"ID": "20250401145601-yg0ehzi",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250401145601-yg0ehzi",
												"updated": "20250401145601"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "在一个PF上可以衍生出来多个VF，一个PE最多有64000个与其相关联的VF"
												}
											]
										}
									]
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-aux8rts",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-aux8rts",
				"updated": "20250401145606"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\t"
				},
				{
					"Type": "NodeTextMark",
					"TextMarkType": "strong",
					"TextMarkTextContent": "作用："
				},
				{
					"Type": "NodeText",
					"Data": "为虚拟机提供接口、进行数据的发送与接收功能、与PE通信完成全局相关配置"
				}
			]
		},
		{
			"ID": "20250327012435-9plxnnk",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-9plxnnk",
				"updated": "20250401145713"
			},
			"Children": [
				{
					"ID": "20250401145713-b9y79ec",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250401145713-b9y79ec",
						"updated": "20250401145713"
					},
					"Children": [
						{
							"ID": "20250401145713-ad2sudy",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250401145713-ad2sudy",
								"updated": "20250401145713"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "strong",
									"TextMarkTextContent": "具体的工作流程"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-kk0xruw",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-kk0xruw",
				"updated": "20250401145728"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "\t虚拟机和VF设备的交互与IO直通的交互类似，只不过SR-IOV是多个虚拟机共享同一个I/O设备。既然VF可以作为一个正常的PCIE设备透传给虚拟机使用，那是否会遇到在使用一个正常的物理设备透传给这个虚拟机所需要的问题（也就是IO直通所遇到的问题）？"
				}
			]
		},
		{
			"ID": "20250327012435-xdpycvk",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-xdpycvk",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "答案是会遇到"
				}
			]
		},
		{
			"ID": "20250327012435-n6loo8t",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-n6loo8t",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "我们知道IO直通场景下有一个重要的阶段IO数据的传输，当DMA请求时，需要通过IOMMU模块将GPA翻译为HPA来完成内存的读写"
				}
			]
		},
		{
			"ID": "20250327012435-emnwnh6",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-emnwnh6",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "VF也是一样的，它支持DMA功能，也会通过IOMMU将GPA转为HPA，从而找到宿主机上正确的HPA，将IO相关的数据写入到目标内存地址中"
				}
			]
		},
		{
			"ID": "20250327012435-s0mjnbo",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-s0mjnbo",
				"updated": "20250327012435"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "因此一个VF设备也会需要有一个自己全局唯一的设备标识符（Src ID）；IOMMU就是通过这个Src ID找到这个VF挂载的虚拟机，找到这个虚拟机的IO内存地址的映射，从而找到这个GPA所映射的HPA"
				}
			]
		},
		{
			"ID": "20250327012435-id56z1d",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20250327012435-id56z1d",
				"updated": "20250401145814"
			},
			"Children": [
				{
					"ID": "20250401145752-m1v6hc4",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20250401145752-m1v6hc4",
						"updated": "20250401145814"
					},
					"Children": [
						{
							"ID": "20250401145752-gevptsi",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20250401145752-gevptsi",
								"updated": "20250401145752"
							},
							"Children": [
								{
									"Type": "NodeTextMark",
									"TextMarkType": "strong",
									"TextMarkTextContent": "特点"
								}
							]
						},
						{
							"ID": "20250401145812-kuawozi",
							"Type": "NodeList",
							"ListData": {},
							"Properties": {
								"id": "20250401145812-kuawozi",
								"updated": "20250401145814"
							},
							"Children": [
								{
									"ID": "20250401145814-yk6olro",
									"Type": "NodeListItem",
									"ListData": {
										"BulletChar": 42,
										"Marker": "Kg=="
									},
									"Properties": {
										"id": "20250401145814-yk6olro",
										"style": "--en-bullet-line-height: 38px;",
										"updated": "20250401145814"
									},
									"Children": [
										{
											"ID": "20250401145814-f9qbx0b",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250401145814-f9qbx0b",
												"updated": "20250401145814"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "只是SR-IOV设备本身是基于虚拟化环境设计的，因此他可以做一些专门针对虚拟化环境的优化（例如可以增加一个本地的高速缓存存放GPA到HPA的映射，从而在某些场景下就省去了查询IOMMU的功夫）"
												}
											]
										}
									]
								},
								{
									"ID": "20250401145822-i0ff92v",
									"Type": "NodeListItem",
									"ListData": {
										"BulletChar": 42,
										"Marker": "Kg=="
									},
									"Properties": {
										"id": "20250401145822-i0ff92v",
										"style": "--en-bullet-line-height: 102px;",
										"updated": "20250401145822"
									},
									"Children": [
										{
											"ID": "20250401145822-tuews3h",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250401145822-tuews3h",
												"updated": "20250401145822"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "建立了基于PF\u0026VF的标准"
												}
											]
										}
									]
								},
								{
									"ID": "20250401145826-i6kjyyw",
									"Type": "NodeListItem",
									"ListData": {
										"BulletChar": 42,
										"Marker": "Kg=="
									},
									"Properties": {
										"id": "20250401145826-i6kjyyw",
										"updated": "20250401145826"
									},
									"Children": [
										{
											"ID": "20250401145826-94p2auz",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20250401145826-94p2auz",
												"updated": "20250401145826"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "性能最高，几乎和直接使用硬件I/O设备没有区别"
												}
											]
										}
									]
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20250327012435-2s08ry1",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-2s08ry1",
				"updated": "20250328011330"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "https://i-blog.csdnimg.cn/blog_migrate/32f3592aa70adb4aff67e78f4bdcebc8.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "​"
				}
			]
		},
		{
			"ID": "20250327012435-zgyx4kg",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-zgyx4kg",
				"updated": "20250327012435"
			}
		},
		{
			"ID": "20250327012435-4yjg3x2",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-4yjg3x2",
				"updated": "20250327012435"
			}
		},
		{
			"ID": "20250327012435-2spwl4t",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-2spwl4t",
				"updated": "20250327012435"
			}
		},
		{
			"ID": "20250327012435-2jzamsh",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-2jzamsh",
				"updated": "20250327012435"
			}
		},
		{
			"ID": "20250327012435-a00y3op",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20250327012435-a00y3op",
				"updated": "20250327012435"
			}
		}
	]
}